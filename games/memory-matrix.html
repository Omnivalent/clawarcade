<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com; font-src https://fonts.gstatic.com data:; img-src 'self' data: blob:; connect-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer" content="no-referrer">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Memory Matrix</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#1a1a2e;color:#e0e0e0;font-family:'Segoe UI',system-ui,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100dvh;overflow:hidden;touch-action:manipulation;user-select:none}
h1{font-size:1.4rem;color:#00d4aa;margin-bottom:4px}
#info{font-size:0.9rem;color:#8888aa;margin-bottom:10px;text-align:center}
#grid{display:grid;gap:6px;margin:10px auto}
.cell{background:#16213e;border-radius:8px;cursor:pointer;transition:background .15s;min-width:44px;min-height:44px}
.cell.highlight{background:#00d4aa}
.cell.selected{background:#0f9b8e}
.cell.correct{background:#00d4aa;animation:pop .3s}
.cell.wrong{background:#e74c3c;animation:shake .3s}
@keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}
#hud{display:flex;gap:20px;font-size:1rem;margin-bottom:8px}
#hud span{color:#00d4aa}
.btn{background:#00d4aa;color:#1a1a2e;border:none;padding:12px 28px;border-radius:8px;font-size:1rem;font-weight:700;cursor:pointer;min-height:44px;margin-top:12px}
.btn:active{transform:scale(.95)}
#msg{font-size:1.1rem;color:#00d4aa;margin-top:8px;min-height:1.4em;text-align:center}
</style>
</head>
<body>
<h1>Memory Matrix</h1>
<div id="hud">Level: <span id="lvl">1</span> | Score: <span id="score">0</span></div>
<div id="info">Memorize the pattern, then tap to reproduce it</div>
<div id="grid"></div>
<div id="msg"></div>
<button class="btn" id="startBtn" onclick="startGame()">Start</button>
<script>
const grid=document.getElementById('grid'),msg=document.getElementById('msg'),lvlEl=document.getElementById('lvl'),scoreEl=document.getElementById('score'),startBtn=document.getElementById('startBtn');
let level=1,score=0,size=3,pattern=[],playerPicks=[],accepting=false;

function startGame(){level=1;score=0;updateHud();nextRound()}
function updateHud(){lvlEl.textContent=level;scoreEl.textContent=score}
function nextRound(){
  accepting=false;msg.textContent='';startBtn.style.display='none';
  size=Math.min(3+Math.floor((level-1)/3),7);
  let count=Math.min(2+level,Math.floor(size*size*0.45));
  buildGrid();
  // pick random cells
  let all=[...Array(size*size).keys()];
  pattern=[];
  while(pattern.length<count){let i=all.splice(Math.floor(Math.random()*all.length),1)[0];pattern.push(i)}
  // show pattern
  setTimeout(()=>{pattern.forEach(i=>{grid.children[i].classList.add('highlight')});
    setTimeout(()=>{[...grid.children].forEach(c=>c.classList.remove('highlight'));
      accepting=true;playerPicks=[];msg.textContent='Your turn!'},800+level*150)},400);
}
function buildGrid(){
  grid.innerHTML='';
  let cellSize=Math.min(Math.floor((Math.min(window.innerWidth,window.innerHeight)-60)/size),70);
  grid.style.gridTemplateColumns=`repeat(${size},${cellSize}px)`;
  for(let i=0;i<size*size;i++){
    let c=document.createElement('div');c.className='cell';c.style.width=cellSize+'px';c.style.height=cellSize+'px';
    c.addEventListener('click',()=>pick(i,c));grid.appendChild(c);
  }
}
function pick(i,c){
  if(!accepting||playerPicks.includes(i))return;
  playerPicks.push(i);
  if(pattern.includes(i)){c.classList.add('correct');
    if(playerPicks.filter(p=>pattern.includes(p)).length===pattern.length){
      accepting=false;score+=level*10;level++;updateHud();msg.textContent='✓ Perfect!';
      setTimeout(nextRound,900);
    }
  }else{c.classList.add('wrong');accepting=false;
    // show correct
    pattern.forEach(j=>grid.children[j].classList.add('highlight'));
    msg.textContent=`✗ Game Over! Score: ${score}`;startBtn.style.display='inline-block';startBtn.textContent='Retry';
  }
}
</script>
</body>
</html>
