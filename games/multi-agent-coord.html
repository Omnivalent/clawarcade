<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>Multi-Agent Coordination</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#1a1a2e;color:#e0e0e0;font-family:'Segoe UI',system-ui,sans-serif;height:100dvh;overflow:hidden;display:flex;flex-direction:column;align-items:center;padding:12px}
h1{color:#00d4aa;font-size:1.3em;margin:8px 0}
.sub{color:#888;font-size:.85em;margin-bottom:8px}
#game{width:100%;max-width:500px;flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch}
.card{background:#16213e;border-radius:12px;padding:14px;margin:6px 0;border:1px solid #0f3460}
.hud{display:flex;justify-content:space-between;padding:6px 0;font-size:.85em;color:#00d4aa}
.grid{display:grid;gap:3px;margin:8px auto;width:fit-content}
.cell{width:44px;height:44px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:1.2em;background:#0a0a1a;border:1px solid #0f3460;transition:all .2s}
.cell.wall{background:#2c2c4a;border-color:#3c3c5a}
.cell.goal{background:#00d4aa22;border-color:#00d4aa}
.cell.agent{font-size:1.3em}
.cell.done{background:#00b89444;border-color:#00b894}
.agents-panel{display:flex;gap:8px;margin:8px 0;justify-content:center;flex-wrap:wrap}
.agent-card{background:#0a0a1a;border:2px solid #0f3460;border-radius:10px;padding:10px 14px;text-align:center;cursor:pointer;transition:all .15s;-webkit-tap-highlight-color:transparent;min-width:80px}
.agent-card:active{transform:scale(.95)}
.agent-card.selected{border-color:#00d4aa;background:#00d4aa11}
.agent-card.done{border-color:#00b894;opacity:.5}
.agent-card .emoji{font-size:1.5em}
.agent-card .name{font-size:.75em;color:#888;margin-top:2px}
.agent-card .moves{font-size:.7em;color:#00d4aa}
.controls{display:grid;grid-template-columns:repeat(3,60px);gap:4px;justify-content:center;margin:8px 0}
.ctrl-btn{background:#16213e;border:2px solid #0f3460;border-radius:10px;padding:12px;font-size:1.3em;cursor:pointer;display:flex;align-items:center;justify-content:center;-webkit-tap-highlight-color:transparent;transition:all .1s}
.ctrl-btn:active{background:#0f3460;transform:scale(.9)}
.ctrl-btn.disabled{opacity:.2;pointer-events:none}
.btn{background:#00d4aa;color:#1a1a2e;border:none;border-radius:10px;padding:14px 20px;font-size:1em;font-weight:700;cursor:pointer;width:100%;margin:6px 0;transition:all .15s;-webkit-tap-highlight-color:transparent}
.btn:active{transform:scale(.96)}
.btn.small{padding:10px;font-size:.9em}
.center{text-align:center}
.fade{animation:fadeIn .3s}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1}}
.big{font-size:2em;margin:8px 0}
.mission{background:#0a0a1a;border-left:4px solid #00d4aa;padding:10px;margin:6px 0;border-radius:0 8px 8px 0;font-size:.85em;line-height:1.4;color:#aaa}
</style>
</head>
<body>
<h1>ğŸ¤– Multi-Agent Coordination</h1>
<p class="sub">Guide agents to their goals</p>
<div id="game"></div>
<script>
const puzzles=[
{name:"The Handoff",cols:5,rows:5,maxMoves:12,
desc:"Agent A needs to reach the ğŸ“¦, then Agent B picks it up and delivers to ğŸ .",
walls:[[1,2],[2,2],[3,2]],
agents:[{emoji:"ğŸ”µ",name:"Alpha",x:0,y:0,goalX:4,goalY:2,goalEmoji:"ğŸ“¦"},{emoji:"ğŸŸ¢",name:"Beta",x:4,y:4,goalX:0,goalY:4,goalEmoji:"ğŸ "}],
sequence:true},// must complete in order
{name:"Parallel Paths",cols:6,rows:5,maxMoves:16,
desc:"Both agents must reach their goals. They can't occupy the same cell!",
walls:[[2,1],[2,2],[2,3],[3,1],[3,3]],
agents:[{emoji:"ğŸ”µ",name:"Alpha",x:0,y:0,goalX:5,goalY:0,goalEmoji:"â­"},{emoji:"ğŸŸ¢",name:"Beta",x:0,y:4,goalX:5,goalY:4,goalEmoji:"ğŸ’"}],
sequence:false},
{name:"Three's Company",cols:6,rows:6,maxMoves:24,
desc:"Three agents, three goals. No collisions! Plan your moves carefully.",
walls:[[1,3],[2,3],[3,1],[3,2],[4,3],[4,4]],
agents:[{emoji:"ğŸ”µ",name:"Alpha",x:0,y:0,goalX:5,goalY:5,goalEmoji:"â­"},{emoji:"ğŸŸ¢",name:"Beta",x:5,y:0,goalX:0,goalY:5,goalEmoji:"ğŸ’"},{emoji:"ğŸ”´",name:"Gamma",x:2,y:2,goalX:5,goalY:2,goalEmoji:"ğŸ†"}],
sequence:false}
];

let pIdx=0,moves=0,selAgent=0,state=[];
const G=document.getElementById('game');

function startScreen(){
G.innerHTML=`<div class="card center fade">
<div class="big">ğŸ¤–</div>
<p style="margin:8px 0">Coordinate multiple AI agents to complete missions.</p>
<p style="color:#888;font-size:.9em">Select an agent, use arrows to move. Agents can't overlap!</p>
<p style="color:#00d4aa;margin:8px 0">${puzzles.length} puzzles</p>
<button class="btn" onclick="startPuzzle()">Start</button>
</div>`;
}

function startPuzzle(){
if(pIdx>=puzzles.length){endGame();return}
const p=puzzles[pIdx];
moves=0;selAgent=0;
state=p.agents.map(a=>({...a,done:false}));
renderPuzzle();
}

function renderPuzzle(){
const p=puzzles[pIdx];
const wallSet=new Set(p.walls.map(w=>w[0]+','+w[1]));

let gridHtml='';
for(let y=0;y<p.rows;y++){
for(let x=0;x<p.cols;x++){
const key=x+','+y;
const isWall=wallSet.has(key);
const agent=state.find(a=>a.x===x&&a.y===y);
const goal=state.find(a=>a.goalX===x&&a.goalY===y&&!a.done);
let cls='cell';
let content='';
if(isWall){cls+=' wall';content='ğŸ§±'}
else if(agent){cls+=' agent';content=agent.emoji;if(agent.done)cls+=' done'}
else if(goal){cls+=' goal';content=goal.goalEmoji}
gridHtml+=`<div class="${cls}">${content}</div>`;
}}

let agentCards=state.map((a,i)=>`<div class="agent-card ${i===selAgent?'selected':''} ${a.done?'done':''}" onclick="selAgent=${i};renderPuzzle()">
<div class="emoji">${a.emoji}</div><div class="name">${a.name}</div><div class="moves">${a.done?'âœ… Done':'Ready'}</div></div>`).join('');

const allDone=state.every(a=>a.done);
const canMove=moves<p.maxMoves&&!allDone;

G.innerHTML=`<div class="hud"><span>Puzzle ${pIdx+1}: ${p.name}</span><span>Moves: ${moves}/${p.maxMoves}</span></div>
<div class="mission">${p.desc}</div>
<div class="agents-panel">${agentCards}</div>
<div class="grid" style="grid-template-columns:repeat(${p.cols},44px)">${gridHtml}</div>
<div class="controls">
<div></div><div class="ctrl-btn ${canMove?'':'disabled'}" onclick="move(0,-1)">â¬†ï¸</div><div></div>
<div class="ctrl-btn ${canMove?'':'disabled'}" onclick="move(-1,0)">â¬…ï¸</div><div class="ctrl-btn ${canMove?'':'disabled'}" onclick="move(0,0)" style="font-size:.8em">â¸ï¸</div><div class="ctrl-btn ${canMove?'':'disabled'}" onclick="move(1,0)">â¡ï¸</div>
<div></div><div class="ctrl-btn ${canMove?'':'disabled'}" onclick="move(0,1)">â¬‡ï¸</div><div></div>
</div>
${allDone?`<div class="card center fade"><p style="color:#00b894;font-weight:700">ğŸ‰ Puzzle Complete! ${moves} moves used</p><button class="btn" onclick="pIdx++;startPuzzle()">Next Puzzle â†’</button></div>`:''}
${!allDone&&moves>=p.maxMoves?`<div class="card center fade"><p style="color:#e74c3c;font-weight:700">Out of moves!</p><button class="btn" onclick="startPuzzle()">Retry</button></div>`:''}
<button class="btn small" onclick="startPuzzle()" style="background:#0f3460;color:#888">â†º Reset Puzzle</button>`;

// Keyboard
document.onkeydown=e=>{
if(!canMove)return;
if(e.key==='ArrowUp')move(0,-1);
else if(e.key==='ArrowDown')move(0,1);
else if(e.key==='ArrowLeft')move(-1,0);
else if(e.key==='ArrowRight')move(1,0);
else if(e.key==='Tab'){e.preventDefault();selAgent=(selAgent+1)%state.length;renderPuzzle()}
};
}

function move(dx,dy){
if(dx===0&&dy===0)return;// skip/wait
const p=puzzles[pIdx];
const a=state[selAgent];
if(a.done)return;
if(p.sequence){const firstUndone=state.findIndex(s=>!s.done);if(selAgent!==firstUndone)return}
const nx=a.x+dx,ny=a.y+dy;
if(nx<0||nx>=p.cols||ny<0||ny>=p.rows)return;
const wallSet=new Set(p.walls.map(w=>w[0]+','+w[1]));
if(wallSet.has(nx+','+ny))return;
if(state.some((o,i)=>i!==selAgent&&!o.done&&o.x===nx&&o.y===ny))return;// collision
a.x=nx;a.y=ny;moves++;
if(a.x===a.goalX&&a.y===a.goalY)a.done=true;
renderPuzzle();
}

function endGame(){
G.innerHTML=`<div class="card center fade">
<div class="big">ğŸ†</div>
<p style="font-size:1.3em;font-weight:700;color:#00d4aa">All Puzzles Complete!</p>
<p style="color:#888;margin:8px 0">You coordinated ${puzzles.reduce((s,p)=>s+p.agents.length,0)} agents across ${puzzles.length} missions</p>
<button class="btn" onclick="pIdx=0;startScreen()">Play Again</button>
</div>`;
}

startScreen();
</script>
</body>
</html>